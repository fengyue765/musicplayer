<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>本地文件音乐播放器</title>
  <!-- RemixIcon CDN -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <!-- 分拆后的样式文件 -->
  <link rel="stylesheet" href="styles/theme.css" />
  <link rel="stylesheet" href="styles/layout.css" />
  <link rel="stylesheet" href="styles/controls.css" />
  <link rel="stylesheet" href="styles/playlist.css" />
</head>
<body>
  <div class="decor-bg" aria-hidden="true">
    <svg class="decor-svg" viewBox="0 0 800 120" preserveAspectRatio="none">
      <defs>
        <radialGradient id="g1" cx="20%" cy="20%">
          <stop offset="0%" stop-color="#FCE9F3" stop-opacity="1"/>
          <stop offset="100%" stop-color="#F8D7E9" stop-opacity="0"/>
        </radialGradient>
        <radialGradient id="g2" cx="80%" cy="30%">
          <stop offset="0%" stop-color="#EEE8FF" stop-opacity="1"/>
          <stop offset="100%" stop-color="#E6DBFF" stop-opacity="0"/>
        </radialGradient>
      </defs>
      <rect width="800" height="120" fill="url(#g1)"></rect>
      <circle cx="120" cy="50" r="38" fill="#FFD9E6" opacity="0.9"></circle>
      <circle cx="320" cy="35" r="28" fill="#EDE7FF" opacity="0.95"></circle>
      <circle cx="560" cy="45" r="46" fill="#FFEFF4" opacity="0.9"></circle>
      <rect x="700" y="10" width="80" height="80" rx="20" fill="url(#g2)" opacity="0.6"></rect>
    </svg>
  </div>

  <main class="page">
    <div class="player">
      <header class="player-head">
        <div class="logo">
          <div class="logo-dot pink"></div>
          <div class="logo-dot purple"></div>
          <div class="logo-dot cream"></div>
        </div>
        <div>
          <h1>本地文件音乐播放器</h1>
        </div>
      </header>

      <!-- Update notification banner -->
      <div id="updateNotification" class="update-notification" style="display:none;">
        <div class="update-content">
          <span id="updateMessage">检查更新中...</span>
          <div class="update-actions">
            <button id="downloadUpdateBtn" class="btn subtle" style="display:none;">下载更新</button>
            <button id="installUpdateBtn" class="btn" style="display:none;">安装并重启</button>
            <button id="dismissUpdateBtn" class="btn subtle">关闭</button>
          </div>
        </div>
        <div id="updateProgress" class="update-progress" style="display:none;">
          <div id="updateProgressBar" class="update-progress-bar"></div>
          <span id="updateProgressText">0%</span>
        </div>
      </div>

      <div class="controls-row">
        <button id="chooseDir" class="btn">选择 / 更换 文件夹</button>
        <button id="refreshBtn" class="btn subtle">刷新目录</button>
        <button id="clearSaved" class="btn subtle">清除已记住的文件夹</button>

        <div class="toggle-group">
          <label style="display:flex;align-items:center;gap:8px">
            <input id="autoNormalize" type="checkbox" />
            自动均衡
          </label>
          <button id="shuffleBtn" class="icon-btn" title="随机播放"><i class="ri-shuffle-line"></i></button>
          <button id="repeatBtn" class="icon-btn" title="单曲循环"><i class="ri-repeat-one-line"></i></button>
        </div>
      </div>

      <div class="now">
        <div id="currentTitle">未选择歌曲</div>
      </div>

      <audio id="audio" preload="metadata"></audio>

      <div class="controls">
        <button id="prev" class="control"><i class="ri-skip-back-mini-fill"></i></button>
        <button id="play" class="control large"><i class="ri-play-fill"></i></button>
        <button id="next" class="control"><i class="ri-skip-forward-mini-fill"></i></button>
        <input id="seek" type="range" min="0" max="100" value="0" />
        <span id="time" class="time">0:00 / 0:00</span>
      </div>

      <!-- Playlist header: 折叠 / 定位 / 排序 -->
      <div class="playlist-header">
        <div class="playlist-title">播放列表</div>
        <div class="playlist-actions">
          <div class="sort-group">
            <select id="sortSelect" class="sort-select" title="排序方式">
              <option value="default">默认</option>
              <option value="play">播放次数</option>
              <option value="skip">切歌次数</option>
              <option value="completion">完播率</option>
              <option value="name">名称</option>
            </select>
            <button id="sortDirBtn" class="small-btn" title="切换升序/降序">↓</button>
          </div>
          <button id="togglePlaylistBtn" class="small-btn" title="折叠/展开播放列表">折叠/展开</button>
          <button id="locateBtn" class="small-btn" title="定位当前播放歌曲">定位当前</button>
        </div>
      </div>

      <div class="playlist collapsed" id="playlist" aria-live="polite"></div>

      <!-- 操作日志 / 目录状态（播放列表底部） -->
      <br></br>
      <div id="dirStatus" class="muted" aria-live="polite" style="margin-top:10px;">（尚未加载目录）</div>

    </div>
  </main>

  <!-- 入口脚本（使用 ES 模块，方便拆分管理） -->
  <script type="module" src="renderer.js"></script>
</body>
</html>